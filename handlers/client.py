from aiogram import types, Dispatcher
from create_bot import bot 
from keyboard.client_buttons import *
from states.create_states import *
from keyboard.client_inline_buttons import *
from db import create_profile, give_week_today, check_user
from datetime import datetime





async def default_commands(message: types.Message):
    if message.text == '/start':
        await message.delete()
        check = await check_user(user_id=message.from_user.id)
        if check == 1:
            await bot.send_message(message.chat.id, '‚úçÔ∏è <b>ùêòùê®ùêÆùê´ ùêèùê•ùêöùêßùê¨</b>', parse_mode='HTML', reply_markup=main_frame)
        else:
            await create_profile(user_id=message.from_user.id)
            await bot.send_message(message.chat.id, """‚ùì <b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º?</b>
                               
/start - –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ –≤—Å–µ–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

/help - –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞.


–í—Å–µ –ö–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ:

üÜò <b>–ü–æ–º–æ—â—å</b> - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ —Å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –±–æ—Ç–∞.

üìù <b>–î–æ–±–∞–≤. –Ω–∞–ø–æ–º–∏–Ω.</b> - –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è. –í —Ä–∞–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ, –ø–æ—Ç–æ–º –≤—Ä–µ–º—è. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å.

üìù <b>–£–¥–∞–ª. –Ω–∞–ø–æ–º–∏–Ω.</b> - –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è. –í –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –≤—Ä–µ–º—è.

üìî <b>–ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é</b> - –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –≤—Å–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –Ω–∞ –≤—ã–±–æ—Ä (–ü–Ω, –í—Ç, –°—Ä, –ß—Ç, –ü—Ç, C–±, –í—Å). –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫, –≤—ã–≤–µ–¥–µ—Ç –≤–∞—à –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é.

üìî <b>–ò–∑–º–µ–Ω–∏—Ç—å –Ω–µ–¥–µ–ª—é</b> - –∫–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–∏–µ —Ç–≤–æ–µ–π –Ω–µ–¥–µ–ª–∏ (–¥–æ–±–∞–≤–ª—è—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å, —É–¥–∞–ª—è—Ç—å –ø–ª–∞–Ω—ã –Ω–∞ –∫–∞–∂–¥—ã–π –∏–∑ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏)

üóìÔ∏è <b>–ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</b> - –∫–Ω–æ–ø–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–µ—Ç –ø–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏.


""", parse_mode='HTML')
            await bot.send_message(message.chat.id, '‚úçÔ∏è <b>ùêòùê®ùêÆùê´ ùêèùê•ùêöùêßùê¨</b>', parse_mode='HTML', reply_markup=main_frame)
        
        
    elif message.text == '/help':
        await message.delete()
        await bot.send_message(message.chat.id, """‚ùì <b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º?</b>
                               
/start - –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ –≤—Å–µ–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

/help - –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞.


–í—Å–µ –ö–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ:

üÜò <b>–ü–æ–º–æ—â—å</b> - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ —Å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –±–æ—Ç–∞.

üìù <b>–î–æ–±–∞–≤. –Ω–∞–ø–æ–º–∏–Ω.</b> - –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è. –í —Ä–∞–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ, –ø–æ—Ç–æ–º –≤—Ä–µ–º—è. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å.

üìù <b>–£–¥–∞–ª. –Ω–∞–ø–æ–º–∏–Ω.</b> - –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è. –í –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –≤—Ä–µ–º—è.

üìî <b>–ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é</b> - –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –≤—Å–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –Ω–∞ –≤—ã–±–æ—Ä (–ü–Ω, –í—Ç, –°—Ä, –ß—Ç, –ü—Ç, C–±, –í—Å). –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫, –≤—ã–≤–µ–¥–µ—Ç –≤–∞—à –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é.

üìî <b>–ò–∑–º–µ–Ω–∏—Ç—å –Ω–µ–¥–µ–ª—é</b> - –∫–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–∏–µ —Ç–≤–æ–µ–π –Ω–µ–¥–µ–ª–∏ (–¥–æ–±–∞–≤–ª—è—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å, —É–¥–∞–ª—è—Ç—å –ø–ª–∞–Ω—ã –Ω–∞ –∫–∞–∂–¥—ã–π –∏–∑ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏)

üóìÔ∏è <b>–ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</b> - –∫–Ω–æ–ø–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–µ—Ç –ø–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏.
""", parse_mode='HTML')





async def send_message(user_id, text_message, time):
    await bot.send_message(chat_id=user_id, text=f"""
‚ùóÔ∏è<b>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</b>‚ùóÔ∏è

{text_message}

–í—Ä–µ–º—è: {time}""", parse_mode='HTML')
        




async def answer_mesage(user_id):
    now = datetime.now()
    weekday = str(datetime.weekday(now))
    list = await give_week_today(user_id=user_id, week=weekday)
    await bot.send_message(chat_id=user_id, text=f"""‚òÄÔ∏è <b>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!</b> –í–æ—Ç —Ç–≤–æ–π –ø–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!
                           
{list}""")





def register_message(dp: Dispatcher):
    
    dp.register_message_handler(default_commands, commands=['start', 'help'])
    